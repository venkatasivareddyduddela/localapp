<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Funny Pants Collection</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f0f0f0; text-align: center; margin: 0; }
    h1 { margin: 20px 0; }
    .search-area { display: flex; justify-content: center; gap: 10px; margin-bottom: 20px; }
    .search-area input, .search-area button { padding: 10px; font-size: 14px; border-radius: 6px; border: 1px solid #ccc; }
    .search-area button { background: #007bff; color: white; cursor: pointer; border: none; }
    form { margin-bottom: 20px; }
    .gallery { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; max-width: 1200px; margin: auto; }
    .card { background: white; padding: 10px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    .card img { width: 100%; height: 250px; object-fit: contain; cursor: pointer; background: #fafafa; border-radius: 6px; }
    .info { margin-top: 8px; font-weight: bold; font-size: 14px; }
    .order-btn { margin-top: 10px; width: 100%; padding: 8px; border: none; border-radius: 6px; background: #28a745; color: white; cursor: pointer; }
  </style>
</head>
<body>

<h1>Funny Pants Collection</h1>

<div class="search-area">
  <input type="text" id="searchInput" placeholder="Search by Pant ID">
  <button id="searchBtn">Search</button>
  <button id="showAllBtn">Show All</button>
  <button onclick="openCustomerPage()">View Customer Page</button>
</div>

<form id="uploadForm" enctype="multipart/form-data">
  <input type="file" name="image" accept="image/*" required>
  <input type="text" name="pant_id" placeholder="Pant ID" required>
  <input type="text" name="size" placeholder="Size" required>
  <input type="number" name="cost" placeholder="Cost" required>
  <input type="text" name="about" placeholder="Description">
  <button type="submit">Upload Pant</button>
</form>

<div class="gallery" id="gallery"></div>

<script>
const gallery = document.getElementById("gallery");
const searchInput = document.getElementById("searchInput");
const searchBtn = document.getElementById("searchBtn");
const showAllBtn = document.getElementById("showAllBtn");
const uploadForm = document.getElementById("uploadForm");

// Load pants from DB
function loadPants() {
  fetch("fetch_fpants.php")
    .then(res => res.json())
    .then(data => showPants(data));
}

function showPants(pants) {
  gallery.innerHTML = "";
  if (!pants || pants.length === 0) {
    gallery.innerHTML = `<p>No pants available.</p>`;
    return;
  }

  pants.forEach(pant => {
    const card = document.createElement("div");
    card.className = "card";

    const img = document.createElement("img");
    img.src = pant.image;
    img.title = "Click to delete";

    img.onclick = () => {
      if (confirm("Delete Pant ID: " + pant.id + "?")) {
        fetch("delete_fpants.php", {
          method: "POST",
          headers: { "Content-Type": "application/x-www-form-urlencoded" },
          body: "id=" + pant.dbId
        })
        .then(res => res.text())
        .then(msg => {
          alert(msg);
          loadPants();
        });
      }
    };

    const info = document.createElement("div");
    info.className = "info";
    info.innerHTML = `
      <div>ID: ${pant.id}</div>
      <div>Size: ${pant.size}</div>
      <div>Cost: â‚¹${pant.cost}</div>
      <div>${pant.about}</div>
    `;

    const btn = document.createElement("button");
    btn.className = "order-btn";
    btn.textContent = "Order Now";
    btn.onclick = () => alert("Ordered Pant ID: " + pant.id);

    card.append(img, info, btn);
    gallery.appendChild(card);
  });
}

// Upload form
uploadForm.addEventListener("submit", e => {
  e.preventDefault();
  const formData = new FormData(uploadForm);
  fetch("upload_fpants.php", { method: "POST", body: formData })
    .then(res => res.text())
    .then(msg => {
      alert(msg);
      uploadForm.reset();
      loadPants();
    });
});

// Search
function doSearch() {
  const key = searchInput.value.trim();
  if (key === "") return gallery.innerHTML = `<p>Please enter a Pant ID.</p>`;
  fetch("fetch_fpants.php")
    .then(res => res.json())
    .then(data => {
      const found = data.filter(p => p.id.toUpperCase() === key.toUpperCase());
      found.length ? showPants(found) : gallery.innerHTML = `<p>No Pant Found With ID "${key}"</p>`;
    });
}

searchBtn.addEventListener("click", doSearch);
searchInput.addEventListener("keydown", e => { if (e.key === "Enter") { e.preventDefault(); doSearch(); } });
showAllBtn.addEventListener("click", () => { searchInput.value = ""; loadPants(); });

// Customer page
function openCustomerPage() {
  window.open("upload_fpants.php", "_blank");
}

// Initial load
loadPants();
</script>

</body>
</html>

